<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>MirrorVI.jl · MirrorVI.jl</title><meta name="title" content="MirrorVI.jl · MirrorVI.jl"/><meta property="og:title" content="MirrorVI.jl · MirrorVI.jl"/><meta property="twitter:title" content="MirrorVI.jl · MirrorVI.jl"/><meta name="description" content="Documentation for MirrorVI.jl."/><meta property="og:description" content="Documentation for MirrorVI.jl."/><meta property="twitter:description" content="Documentation for MirrorVI.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>MirrorVI.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>MirrorVI.jl</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>MirrorVI.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>MirrorVI.jl</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/marcoelba/MirrorVI.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/marcoelba/MirrorVI.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="MirrorVI.jl"><a class="docs-heading-anchor" href="#MirrorVI.jl">MirrorVI.jl</a><a id="MirrorVI.jl-1"></a><a class="docs-heading-anchor-permalink" href="#MirrorVI.jl" title="Permalink"></a></h1><p>Documentation for MirrorVI.jl</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MirrorVI.ConstantDistribution" href="#MirrorVI.ConstantDistribution"><code>MirrorVI.ConstantDistribution</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Univariate Constant Distribution</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcoelba/MirrorVI.jl/blob/89d1e7a3e4259edefdf7086f025abb7bbc8b250b/src/model_building/normal_degenerate.jl#L4-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MirrorVI.compute_logpdf_prior-Tuple{ComponentArrays.ComponentArray}" href="#MirrorVI.compute_logpdf_prior-Tuple{ComponentArrays.ComponentArray}"><code>MirrorVI.compute_logpdf_prior</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_logpdf_prior(theta::ComponentArray; params_dict::OrderedDict)</code></pre><p>Compute the sum of the log-pdf of the prior distribution.</p><p><strong>Arguments</strong></p><ul><li><code>theta::ComponentArray</code>: ComponentArray with the components of the parameters sample, one component for each prior.</li><li><code>params_dict::OrderedDict</code>: OrderedDict generated using the MirrorVI.utils functions containing the prior details.</li></ul><p><strong>Returns</strong></p><ul><li><code>Real</code>: The sum of the log-pdf components.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcoelba/MirrorVI.jl/blob/89d1e7a3e4259edefdf7086f025abb7bbc8b250b/src/model_building/training_utils.jl#L81-L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MirrorVI.cyclical_polynomial_decay" href="#MirrorVI.cyclical_polynomial_decay"><code>MirrorVI.cyclical_polynomial_decay</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cyclical_polynomial_decay(n_iter::Int64, n_cycles::Int64=2)</code></pre><p>Generate a cyclical polynomial decay schedule over <code>n_iter</code> iterations, divided into <code>n_cycles</code> cycles.</p><p>This function creates a learning rate schedule where the polynomial decay is applied cyclically.     Each cycle consists of <code>steps_per_cycle = n_iter / n_cycles</code> steps, and the <code>polynomial_decay</code> function is applied within each cycle.</p><p><strong>Arguments</strong></p><ul><li><code>n_iter::Int64</code>: The total number of iterations for the schedule.</li><li><code>n_cycles::Int64=2</code>: The number of cycles to divide the iterations into. Default is <code>2</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Float32}</code>: A vector of decayed values representing the learning rate schedule.</li></ul><p><strong>Examples</strong></p><p>```julia julia&gt; schedule = cyclical<em>polynomial</em>decay(10, 2)  # 10 iterations, 2 cycles 10-element Vector{Float32}:  0.17782794  0.125  0.09765625  0.080566406  0.06871948  0.17782794  0.125  0.09765625  0.080566406  0.06871948</p><p>julia&gt; length(schedule)  # Total number of iterations 10</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcoelba/MirrorVI.jl/blob/89d1e7a3e4259edefdf7086f025abb7bbc8b250b/src/model_building/training_utils.jl#L38-L70">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MirrorVI.elbo-Tuple{AbstractArray}" href="#MirrorVI.elbo-Tuple{AbstractArray}"><code>MirrorVI.elbo</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">elbo(
    z::AbstractArray;
    y::AbstractArray,
    X::AbstractArray,
    ranges_z::AbstractArray,
    vi_family_array::AbstractArray,
    random_weights::AbstractArray,
    model,
    theta_axes::Tuple,
    log_likelihood,
    log_prior=zero,
    n_samples::Int64=1,
    n_repeated_measures::Int64=1
)</code></pre><p>Compute the Evidence Lower Bound (ELBO) for a variational inference problem.</p><p>The ELBO is a key quantity in variational inference, used to approximate the posterior distribution of model parameters. This function computes the ELBO by:</p><ol><li>Sampling from the variational distribution.</li><li>Evaluating the log-likelihood and log-prior of the model.  Optional: Takes into account repeated measurements, if it is required</li><li>Adding the entropy of the variational distribution.</li></ol><p><strong>Arguments</strong></p><ul><li><code>z::AbstractArray</code>: The variational parameters used to define the variational distribution.</li><li><code>y::AbstractArray</code>: The observed data (target values).</li><li><code>X::AbstractArray</code>: The input data (features).</li><li><code>ranges_z::AbstractArray</code>: Specifies how <code>z</code> is divided among the parameters of the variational distribution.</li><li><code>vi_family_array::AbstractArray</code>: An array of functions defining the variational family for each parameter.</li><li><code>random_weights::AbstractArray</code>: Boolean array of the same dimension as theta, stating whether each parameter is random or not.</li><li><code>model</code>: A function representing the model, which takes parameters and input data <code>X</code> (keyword argument) and returns atuple with the predictions.</li><li><code>theta_axes::ComponentArrays.Axes</code>: The axes for constructing a <code>ComponentArray</code> from the sampled parameters.</li><li><code>log_likelihood</code>: A function that computes the log-likelihood of the observed data given the model predictions.</li><li><code>log_prior=zero</code>: A function that computes the log-prior of the parameters. Default is <code>zero</code> (no prior).</li><li><code>n_samples::Int64=1</code>: The number of Monte Carlo samples to use for approximating the ELBO. Default is <code>1</code>.</li><li><code>n_repeated_measures::Int64=1</code>: The number of repeated measurements (e.g., for longitudinal data). Default is <code>1</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: The negative ELBO value (to be minimized).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcoelba/MirrorVI.jl/blob/89d1e7a3e4259edefdf7086f025abb7bbc8b250b/src/model_building/training_utils.jl#L162-L204">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MirrorVI.get_parameters_axes-Tuple{OrderedCollections.OrderedDict}" href="#MirrorVI.get_parameters_axes-Tuple{OrderedCollections.OrderedDict}"><code>MirrorVI.get_parameters_axes</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_parameters_axes(params_dict::OrderedDict)</code></pre><p>Generate the parameters axes as needed by the library ComponentArrays. This function processes a dictionary of parameters (<code>params_dict</code>) and constructs a prototype array with the same structure as the parameters. The axes of this prototype array are returned, which can be used to initialize a <code>ComponentArray</code> with the correct structure.</p><p><strong>Arguments</strong></p><ul><li><code>params_dict::OrderedDict</code>: OrderedDict generated using the MirrorVI.utils functions containing the prior details.</li></ul><p><strong>Returns</strong></p><ul><li><code>Tuple</code>: The axes of the prototype array, which can be used to initialize a <code>ComponentArray</code> with the same structure as the parameters.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcoelba/MirrorVI.jl/blob/89d1e7a3e4259edefdf7086f025abb7bbc8b250b/src/model_building/training_utils.jl#L109-L121">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MirrorVI.hybrid_training_loop-Tuple{}" href="#MirrorVI.hybrid_training_loop-Tuple{}"><code>MirrorVI.hybrid_training_loop</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hybrid_training_loop(;
    z::AbstractArray,
    y::AbstractArray,
    X::AbstractArray,
    params_dict::OrderedDict,
    model,
    log_likelihood,
    log_prior=zero,
    n_iter::Int64,
    optimiser::Optimisers.AbstractRule,
    save_all::Bool=false,
    use_noisy_grads::Bool=false,
    elbo_samples::Int64=1,
    lr_schedule=nothing,
    n_repeated_measures::Int64=1,
    dropout::Bool=false,
    start_dropout_iter::Int=0
)</code></pre><p>Run a training loop for variational inference, combining gradient-based optimization with optional noise injection and dropout (experimental).</p><p>This function performs variational inference by minimizing the Evidence Lower Bound (ELBO) using gradient-based optimization. It supports:</p><ul><li>Noisy gradients for exploration.</li><li>Dropout for regularization.</li><li>Cyclical learning rate schedules.</li><li>Saving intermediate results for analysis.</li></ul><p><strong>Arguments</strong></p><ul><li><code>z::AbstractArray</code>: Initial variational parameters.</li><li><code>y::AbstractArray</code>: Observed data (target values).</li><li><code>X::AbstractArray</code>: Input data (features).</li><li><code>params_dict::OrderedDict</code>: Ordered Dictionary defined through MirrorVI.utils functions, containing configuration for the variational family, parameter ranges, and other settings. Must include:<ul><li><code>&quot;vi_family_array&quot;</code>: Array of functions defining the variational family for each parameter.</li><li><code>&quot;ranges_z&quot;</code>: Specifies how <code>z</code> is divided among the parameters of the variational distribution.</li><li><code>&quot;random_weights&quot;</code>: Weights used for sampling from the variational distribution.</li><li><code>&quot;noisy_gradients&quot;</code>: Standard deviation of noise added to gradients (if <code>use_noisy_grads=true</code>).</li></ul></li><li><code>model</code>: A function representing the model, which takes parameters and input data <code>X</code> and returns predictions.</li><li><code>log_likelihood</code>: A function that computes the log-likelihood of the observed data given the model predictions.</li><li><code>log_prior=zero</code>: A function that computes the log-prior of the parameters. Default is <code>zero</code> (no prior).</li><li><code>n_iter::Int64</code>: Number of training iterations.</li><li><code>optimiser::Optimisers.AbstractRule</code>: Optimiser to use for updating <code>z</code> (e.g., <code>DecayedADAGrad</code>).</li><li><code>save_all::Bool=false</code>: If <code>true</code>, saves the trace of <code>z</code> across all iterations. Default is <code>false</code>.</li><li><code>use_noisy_grads::Bool=false</code>: If <code>true</code>, adds noise to the gradients during training. Default is <code>false</code>.</li><li><code>elbo_samples::Int64=1</code>: Number of Monte Carlo samples to use for approximating the ELBO. Default is <code>1</code>.</li><li><code>lr_schedule=nothing</code>: Learning rate schedule (e.g., from <code>cyclical_polynomial_decay</code>). Default is <code>nothing</code>.</li><li><code>n_repeated_measures::Int64=1</code>: Number of repeated measurements (e.g., for time-series data). Default is <code>1</code>.</li><li><code>dropout::Bool=false</code>: If <code>true</code>, applies dropout to <code>z</code> during training. Default is <code>false</code>.</li><li><code>start_dropout_iter::Int=0</code>: Iteration at which to start applying dropout. Default is <code>0</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict</code>: A dictionary containing:<ul><li><code>&quot;loss_dict&quot;</code>: A dictionary with keys:<ul><li><code>&quot;loss&quot;</code>: Array of ELBO values across iterations.</li><li><code>&quot;z_trace&quot;</code>: Trace of <code>z</code> across iterations (if <code>save_all=true</code>).</li></ul></li><li><code>&quot;best_iter_dict&quot;</code>: A dictionary with keys:<ul><li><code>&quot;best_loss&quot;</code>: Best ELBO value achieved.</li><li><code>&quot;best_z&quot;</code>: Variational parameters corresponding to the best ELBO.</li><li><code>&quot;final_z&quot;</code>: Final variational parameters after training.</li><li><code>&quot;best_iter&quot;</code>: Iteration at which the best ELBO was achieved.</li></ul></li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcoelba/MirrorVI.jl/blob/89d1e7a3e4259edefdf7086f025abb7bbc8b250b/src/model_building/training_utils.jl#L258-L319">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MirrorVI.polynomial_decay-Tuple{Int64}" href="#MirrorVI.polynomial_decay-Tuple{Int64}"><code>MirrorVI.polynomial_decay</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">polynomial_decay(t::Int64; a::Float32=1f0, b::Float32=0.01f0, gamma::Float32=0.75f0)</code></pre><p>Compute the polynomial decay value at step <code>t</code> using the formula: a * (b + t)^(-gamma)</p><p>This function is commonly used in optimization algorithms (e.g., learning rate scheduling) to decay a value polynomially over time.</p><pre><code class="nohighlight hljs"># Arguments
- `t::Int64`: The current step or time at which to compute the decay.
- `a::Float32=1f0`: The initial scaling factor. Default is `1.0`.
- `b::Float32=0.01f0`: A small constant to avoid division by zero. Default is `0.01`.
- `gamma::Float32=0.75f0`: The decay rate. Controls how quickly the value decays. Default is `0.75`.

# Returns
- `Float32`: The decayed value at step `t`.

# Examples
```julia
julia&gt; polynomial_decay(10)  # Default parameters
0.17782794f0

julia&gt; polynomial_decay(100, a=2.0f0, b=0.1f0, gamma=0.5f0)  # Custom parameters
0.31622776f0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcoelba/MirrorVI.jl/blob/89d1e7a3e4259edefdf7086f025abb7bbc8b250b/src/model_building/training_utils.jl#L8-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MirrorVI.MyOptimisers.DecayedADAGrad" href="#MirrorVI.MyOptimisers.DecayedADAGrad"><code>MirrorVI.MyOptimisers.DecayedADAGrad</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DecayedADAGrad(; η = 0.1, pre = 1.0, post = 0.9)</code></pre><p>Implements a decayed version of AdaGrad. It has parameter specific learning rates based on how frequently it is updated. Does not really need tuning. References: <a href="http://www.jmlr.org/papers/volume12/duchi11a/duchi11a.pdf">ADAGrad</a> optimiser.</p><p><strong>Arguments</strong></p><ul><li><code>η=0.1</code>: learning rate</li><li><code>pre=1.0</code>: weight of new gradient norm</li><li><code>post=0.9</code>: weight of histroy of gradient norms</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Float32}</code>:</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/marcoelba/MirrorVI.jl/blob/89d1e7a3e4259edefdf7086f025abb7bbc8b250b/src/model_building/my_optimisers.jl#L8-L24">source</a></section></article><p>&lt;!– <code>@docs MirrorVI.polynomial_decay(t::Int64; a::Float32=1f0, b::Float32=0.01f0, gamma::Float32=0.75f0)</code> –&gt;</p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Wednesday 26 February 2025 11:58">Wednesday 26 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
